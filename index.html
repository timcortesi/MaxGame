<!DOCTYPE html>
<html>
<head>
<title>Max's Game</title>
<meta name="apple-mobile-web-app-capable" content="yes" />
<script src="assets/js/jquery-3.1.1.min.js"></script>
<script src="assets/js/mustache.min.js"></script>
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
<meta name="viewport" content="user-scalable=no, width=device-width" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="assets/images/max.jpg">
<link rel="shortcut icon" href="assets/images/max-192.png" />
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="assets/css/bootstrap.min.css">
<script>
main_template = `
    <div class="container-fluid" style="background-color:{{background_color}}">
        <div class="row">
            <div class="col-xs-12 header">Where Is {{name}}?</div>
        </div>        
        <div class="row">
            <div class="col-xs-6 cell" data-filename="{{choices.0.filename}}">
                <div class="face" style="background-image:url(assets/people/images/{{choices.0.filename}}.jpg)"></div>
            </div>
            <div class="col-xs-6 cell" data-filename="{{choices.1.filename}}">
                <div class="face" style="background-image:url(assets/people/images/{{choices.1.filename}}.jpg)"></div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-6 cell" data-filename="{{choices.2.filename}}">
                <div class="face" style="background-image:url(assets/people/images/{{choices.2.filename}}.jpg)"></div>
            </div>
            <div class="col-xs-6 cell" data-filename="{{choices.3.filename}}">
                <div class="face" style="background-image:url(assets/people/images/{{choices.3.filename}}.jpg)"></div>
            </div>
        </div>
    </div>
`;
</script>
<script>
document.ontouchmove = function(event){
    event.preventDefault();
}

var prev_object_index = -1;

current_state = {
    "name" : "Dad",
    "filename": "dad",
    "background_color":"f00",
    "choices": [
        {"filename":"dad"},
        {"filename":"dad"},
        {"filename":"dad"},
        {"filename":"dad"}
    ]
}

getRandomColor =function(){
  var letters = '0123456789ABCDEF';
  var color = '#';
  for (var i = 0; i < 6; i++) {
    color += letters[Math.floor(Math.random() * 16)];
  }
  return color;
}

update = function() {
    $('body').html(mustache(main_template,current_state))
}

people_obj = [
    {'filename':'adelyn','color':'gray','name':'Adelyn'},
    {'filename':'aj','color':'gray','name':'AJ'},
    {'filename':'andrew','color':'gray','name':'Uncle Andrew'},
    {'filename':'auntbarbie','color':'gray','name':'Aunt Barbie'},
    {'filename':'auntheidi','color':'gray','name':'Aunt Heidi'},
    {'filename':'auntwendy','color':'gray','name':'Aunt Wendy'},
    {'filename':'becky','color':'gray','name':'Aunt Becky'},
    {'filename':'dad','color':'gray','name':'Dad'},
    {'filename':'elena','color':'gray','name':'Elena'},
    {'filename':'ellie','color':'gray','name':'Ellie'},
    {'filename':'gram','color':'gray','name':'Gram'},
    {'filename':'grandma','color':'gray','name':'Grandma'},
    {'filename':'grandmother','color':'gray','name':'Grandmother'},
    {'filename':'grandpa','color':'gray','name':'Grandpa Cortesi'},
    {'filename':'grandpa2','color':'gray','name':'Grandpa Dancesia'},
    {'filename':'henry','color':'gray','name':'Henry'},
    {'filename':'jamie','color':'gray','name':'Jamie'},
    {'filename':'katrina','color':'gray','name':'Katrina'},
    {'filename':'kristamarie','color':'gray','name':'Kristamarie'},
    {'filename':'max','color':'gray','name':'Maximus'},
    {'filename':'mom','color':'gray','name':'Mom'},
    {'filename':'nick','color':'gray','name':'Nick'},
    {'filename':'rachel','color':'gray','name':'Aunt Rachel'},
    {'filename':'stephanie','color':'gray','name':'Stephanie'},
    {'filename':'tony','color':'gray','name':'Tony'},
    {'filename':'travis','color':'gray','name':'Travis'},
    {'filename':'tyler','color':'gray','name':'Uncle Tyler'},
    {'filename':'uncledavid','color':'gray','name':'Uncle David'},
    {'filename':'uncleed','color':'gray','name':'Uncle Ed'},
    {'filename':'unclemo','color':'gray','name':'Uncle Mo'},
    {'filename':'unclerandy','color':'gray','name':'Uncle Randy'},
];

new_state = function() {
    for(var i=0;i<4;i++) {
        var objects_index = Math.floor((Math.random() * people_obj.length));
        current_state.choices[i].filename = people_obj[objects_index].filename;
    }
    objects_index = Math.floor((Math.random() * people_obj.length));
    current_state.choices[Math.floor((Math.random() * 4))].filename = people_obj[objects_index].filename;
    current_state.name = people_obj[objects_index].name;
    current_state.filename = people_obj[objects_index].filename;
    current_state.background_color = getRandomColor();
    update();

    var audio = new Audio("assets/audio/where_is.m4a");
    audio.play();
    audio.addEventListener("ended", function(){
        var audio = new Audio("assets/people/audio/"+current_state.filename+".m4a");
        audio.play();
    });
}

check_state = function(e) {
    if (e.currentTarget.dataset.filename === current_state.filename) {
        var audio = new Audio("assets/audio/good_job.m4a");
        audio.play();
        audio.addEventListener("ended", function(){
            new_state();
        });

    } else {
        var audio = new Audio("assets/audio/try_again.m4a");
        audio.play();
    }
}

$( document ).ready(function() {
    new_state();
    $('body').on('touchstart mousedown','.cell',check_state);
});

</script>


<style>
.cell {
    text-align:center;
    height:45vh;
}
.header {
    text-align:center;
    height:10vh;
    font-size:30px;
}
.face {
    width:40vmin;
    height:40vmin;
    background-color:black;
    border-radius:40vmin;
    background-size: 40vmin 40vmin;
    background-repeat: no-repeat;
    border:solid;
    border-width:5px;
    display:inline-block;
}
</style>
</head>
<body>

</body>
</html>